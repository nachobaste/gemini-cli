"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[191],{7191:function(e,t,n){n.r(t);var o=n(7437),r=n(29),a=n.n(r),i=n(2265),c=n(759),s=n.n(c);n(5046),n(359),n(9003),n(4840),delete s().Icon.Default.prototype._getIconUrl,s().Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"}),t.default=e=>{let{projects:t,filters:n,onProjectSelect:r,compareMode:c=!1,onAddToComparison:l,selectedForComparison:d=[]}=e,p=(0,i.useRef)(null),u=(0,i.useRef)(null),x=(0,i.useRef)([]),m=(0,i.useRef)(null),f=(0,i.useRef)(null),[b,g]=(0,i.useState)(!1),h=e=>{let t=d.find(t=>t.id===e.id),n=t?50:40,o=t?14:12;return s().divIcon({className:"custom-marker",html:'\n        <div class="marker-container" style="position: relative;">\n          <div class="marker-pin" style="\n            width: '.concat(n,"px;\n            height: ").concat(n,"px;\n            background: linear-gradient(135deg, ").concat(e.color," 0%, ").concat(e.color,"dd 100%);\n            border: ").concat(t?"4px":"3px"," solid ").concat(t?"#fbbf24":"white",";\n            border-radius: 50%;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-weight: bold;\n            font-size: ").concat(o,"px;\n            color: white;\n            text-shadow: 1px 1px 2px rgba(0,0,0,0.7);\n            box-shadow: 0 ").concat(t?"6px 12px":"4px 8px"," rgba(0,0,0,0.3);\n            cursor: pointer;\n            transition: all 0.3s ease;\n            position: relative;\n            z-index: ").concat(t?"1000":"100",';\n          ">\n            <div style="display: flex; flex-direction: column; align-items: center;">\n              <div style="font-size: ').concat(o-2,'px;">').concat({Residencial:"\uD83C\uDFE0",Comercial:"\uD83C\uDFE2",Oficinas:"\uD83C\uDFEC",Mixto:"\uD83C\uDFD8️",Industrial:"\uD83C\uDFED"}[e.assetClass]||"\uD83D\uDCCD",'</div>\n              <div style="font-size: ').concat(o-4,'px; margin-top: -2px;">').concat(e.score,'</div>\n            </div>\n          </div>\n          <div class="marker-label" style="\n            position: absolute;\n            top: ').concat(n+5,'px;\n            left: 50%;\n            transform: translateX(-50%);\n            background: rgba(0,0,0,0.9);\n            color: white;\n            padding: 6px 10px;\n            border-radius: 6px;\n            font-size: 11px;\n            white-space: nowrap;\n            pointer-events: none;\n            opacity: 0;\n            transition: opacity 0.3s ease;\n            box-shadow: 0 2px 8px rgba(0,0,0,0.3);\n            z-index: 1001;\n          ">\n            <div style="font-weight: bold; margin-bottom: 2px;">').concat(e.name,'</div>\n            <div style="font-size: 10px; color: #ccc;">').concat(e.assetClass," • Score: ").concat(e.score,"</div>\n          </div>\n          ").concat(t?'\n            <div style="\n              position: absolute;\n              top: -5px;\n              right: -5px;\n              width: 20px;\n              height: 20px;\n              background: #fbbf24;\n              border: 2px solid white;\n              border-radius: 50%;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              font-size: 12px;\n              z-index: 1002;\n            ">✓</div>\n          ':"","\n        </div>\n      "),iconSize:[n,n],iconAnchor:[n/2,n/2]})};return(0,i.useEffect)(()=>{if(!p.current||u.current)return;let e=s().map(p.current,{center:[14.6349,-90.5069],zoom:11,zoomControl:!1,attributionControl:!1,preferCanvas:!0});s().control.zoom({position:"topright"}).addTo(e),s().control.scale({position:"bottomleft"}).addTo(e);let t={map:s().tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:"\xa9 OpenStreetMap contributors \xa9 CARTO",subdomains:"abcd",maxZoom:19}),satellite:s().tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"\xa9 Esri",maxZoom:19}),hybrid:s().tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"\xa9 Esri",maxZoom:19})};return t.map.addTo(e),e.tileLayers=t,m.current=s().markerClusterGroup({chunkedLoading:!0,chunkProgress:(e,t)=>{},iconCreateFunction:e=>{let t=e.getChildCount(),n=e.getAllChildMarkers(),o=n.reduce((e,t)=>{var n;return e+((null===(n=t.options.project)||void 0===n?void 0:n.score)||0)},0)/n.length,r="#6b7280";return r=o>=8.5?"#22c55e":o>=7.5?"#84cc16":o>=6.5?"#eab308":o>=5.5?"#f97316":"#ef4444",s().divIcon({html:'\n            <div style="\n              background: '.concat(r,';\n              border: 3px solid white;\n              border-radius: 50%;\n              width: 40px;\n              height: 40px;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              color: white;\n              font-weight: bold;\n              font-size: 14px;\n              box-shadow: 0 4px 8px rgba(0,0,0,0.3);\n            ">\n              ').concat(t,"\n            </div>\n          "),className:"marker-cluster-custom",iconSize:[40,40]})},spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,maxClusterRadius:50}),e.addLayer(m.current),u.current=e,g(!0),()=>{u.current&&(u.current.remove(),u.current=null,m.current=null,g(!1))}},[]),(0,i.useEffect)(()=>{if(!u.current||!b)return;let e=u.current,t=e.tileLayers;e.eachLayer(t=>{t instanceof s().TileLayer&&e.removeLayer(t)}),t[n.viewMode]&&t[n.viewMode].addTo(e),"hybrid"===n.viewMode&&s().tileLayer("https://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}{r}.png",{attribution:"",subdomains:"abcd",maxZoom:19,pane:"overlayPane"}).addTo(e)},[n.viewMode,b]),(0,i.useEffect)(()=>{if(u.current&&m.current&&b){if(m.current.clearLayers(),x.current.forEach(e=>{u.current&&u.current.hasLayer(e)&&u.current.removeLayer(e)}),x.current=[],f.current&&u.current.hasLayer(f.current)&&(u.current.removeLayer(f.current),f.current=null),n.layers.projects&&t.forEach(e=>{let t=h(e),o=s().marker(e.coordinates,{icon:t});o.on("mouseover",e=>{let t=e.target.getElement();if(t){let e=t.querySelector(".marker-container"),n=null==e?void 0:e.querySelector(".marker-pin"),o=null==e?void 0:e.querySelector(".marker-label");n&&(n.style.transform="scale(1.1)",n.style.zIndex="1000"),o&&(o.style.opacity="1")}}),o.on("mouseout",e=>{let t=e.target.getElement();if(t){let e=t.querySelector(".marker-container"),n=null==e?void 0:e.querySelector(".marker-pin"),o=null==e?void 0:e.querySelector(".marker-label");n&&(n.style.transform="scale(1)",n.style.zIndex="auto"),o&&(o.style.opacity="0")}}),o.on("click",()=>{r(e),u.current.flyTo(e.coordinates,15,{duration:1.5})});let a='\n          <div style="min-width: 250px; font-family: Inter, sans-serif;">\n            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">\n              <h3 style="margin: 0; font-size: 18px; font-weight: bold; color: #1f2937; flex: 1;">'.concat(e.name,'</h3>\n              <div style="\n                background: ').concat(e.color,';\n                color: white;\n                padding: 4px 10px;\n                border-radius: 16px;\n                font-size: 14px;\n                font-weight: bold;\n                margin-left: 8px;\n              ">').concat(e.score,'</div>\n            </div>\n            \n            <div style="display: flex; align-items: center; margin-bottom: 8px; color: #6b7280;">\n              <svg style="width: 14px; height: 14px; margin-right: 6px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>\n              </svg>\n              <span style="font-size: 14px;">').concat(e.address,'</span>\n            </div>\n            \n            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 12px; font-size: 13px;">\n              <div>\n                <div style="color: #9ca3af; margin-bottom: 2px;">Presupuesto</div>\n                <div style="font-weight: 600; color: #374151;">$').concat((e.budget/1e6).toFixed(1),'M</div>\n              </div>\n              <div>\n                <div style="color: #9ca3af; margin-bottom: 2px;">\xc1rea</div>\n                <div style="font-weight: 600; color: #374151;">').concat(e.area.toLocaleString(),' m\xb2</div>\n              </div>\n              <div>\n                <div style="color: #9ca3af; margin-bottom: 2px;">Unidades</div>\n                <div style="font-weight: 600; color: #374151;">').concat(e.units,'</div>\n              </div>\n              <div>\n                <div style="color: #9ca3af; margin-bottom: 2px;">Pisos</div>\n                <div style="font-weight: 600; color: #374151;">').concat(e.floors,'</div>\n              </div>\n            </div>\n            \n            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px;">\n              <div style="display: flex; align-items: center;">\n                <div style="\n                  width: 12px;\n                  height: 12px;\n                  background: ').concat(e.color,';\n                  border-radius: 50%;\n                  margin-right: 6px;\n                "></div>\n                <span style="font-size: 14px; color: #4b5563; font-weight: 500;">').concat(e.assetClass,'</span>\n              </div>\n              <span style="font-size: 12px; color: #10b981; font-weight: 600; background: #d1fae5; padding: 2px 8px; border-radius: 12px;">').concat(e.status,'</span>\n            </div>\n            \n            <div style="display: flex; gap: 8px;">\n              <a href="/projects/').concat(e.id,'" style="\n                flex: 1;\n                display: inline-block;\n                background: linear-gradient(135deg, #c5ff00 0%, #a3d600 100%);\n                color: black;\n                padding: 8px 16px;\n                border-radius: 8px;\n                text-decoration: none;\n                font-size: 13px;\n                font-weight: 600;\n                text-align: center;\n                transition: transform 0.2s ease;\n              " onmouseover="this.style.transform=\'scale(1.02)\'" onmouseout="this.style.transform=\'scale(1)\'">\n                Ver Detalles\n              </a>\n              ').concat(c?'\n                <button onclick="window.addToComparison && window.addToComparison('.concat(e.id,')" style="\n                  background: #3b82f6;\n                  color: white;\n                  padding: 8px 12px;\n                  border: none;\n                  border-radius: 8px;\n                  font-size: 13px;\n                  font-weight: 600;\n                  cursor: pointer;\n                  transition: background 0.2s ease;\n                " onmouseover="this.style.background=\'#2563eb\'" onmouseout="this.style.background=\'#3b82f6\'">\n                  Comparar\n                </button>\n              '):"","\n            </div>\n          </div>\n        ");o.bindPopup(a,{maxWidth:300,className:"custom-popup"}),n.layers.clusters?m.current.addLayer(o):(o.addTo(u.current),x.current.push(o))}),n.layers.heatmap&&t.length>0){t.map(e=>[e.coordinates[0],e.coordinates[1],e.score/10]);let e=s().layerGroup();t.forEach(t=>{let n=t.score/10,o=s().circle(t.coordinates,{radius:500+1e3*n,fillColor:t.color,fillOpacity:.1+.2*n,color:t.color,weight:1,opacity:.3});e.addLayer(o)}),e.addTo(u.current),f.current=e,x.current.push(e)}if(n.layers.municipalities){let e=s().polygon([[14.7,-90.6],[14.7,-90.4],[14.5,-90.4],[14.5,-90.6],[14.7,-90.6]],{color:"#6b7280",weight:2,opacity:.6,fillColor:"#6b7280",fillOpacity:.05,dashArray:"5, 5"}).addTo(u.current);e.bindTooltip("Ciudad de Guatemala",{permanent:!1,direction:"center",className:"municipality-tooltip"}),x.current.push(e)}n.layers.roads&&[[[14.6349,-90.5069],[14.61,-90.48],[14.58,-90.45]],[[14.6349,-90.5069],[14.62,-90.49],[14.6,-90.47]],[[14.6349,-90.5069],[14.61,-90.52],[14.59,-90.54]]].forEach((e,t)=>{let n=s().polyline(e,{color:"#9ca3af",weight:3,opacity:.7,dashArray:0===t?void 0:"10, 5"}).addTo(u.current);n.bindTooltip("Carretera Principal ".concat(t+1),{permanent:!1,direction:"center"}),x.current.push(n)}),n.layers.population&&[{center:[14.6349,-90.5069],radius:2e3,density:"high"},{center:[14.61,-90.49],radius:1500,density:"medium"},{center:[14.65,-90.52],radius:1e3,density:"low"}].forEach(e=>{let t={high:{color:"#ef4444",opacity:.4},medium:{color:"#f59e0b",opacity:.3},low:{color:"#22c55e",opacity:.2}},n=s().circle(e.center,{radius:e.radius,...t[e.density],fillColor:t[e.density].color,fillOpacity:t[e.density].opacity,weight:2}).addTo(u.current);n.bindTooltip("Densidad Poblacional ".concat("high"===e.density?"Alta":"medium"===e.density?"Media":"Baja"),{permanent:!1,direction:"center"}),x.current.push(n)}),c&&l&&(window.addToComparison=e=>{let n=t.find(t=>t.id===e);n&&l(n)})}},[t,n,r,c,l,d,b]),(0,o.jsxs)("div",{className:"jsx-8906bc3c0fc8bf3 relative w-full h-full z-0",children:[(0,o.jsx)("div",{ref:p,className:"jsx-8906bc3c0fc8bf3 w-full h-full rounded-xl"}),(0,o.jsxs)("div",{className:"jsx-8906bc3c0fc8bf3 absolute top-4 left-4 z-[1000] space-y-2",children:[(0,o.jsxs)("div",{className:"jsx-8906bc3c0fc8bf3 glass-effect rounded-lg p-3",children:[(0,o.jsxs)("div",{className:"jsx-8906bc3c0fc8bf3 text-sm text-gray-700 font-medium mb-1",children:[t.length," Proyectos Visibles"]}),(0,o.jsxs)("div",{className:"jsx-8906bc3c0fc8bf3 text-xs text-gray-500",children:["Score promedio:"," ",t.length>0?(t.reduce((e,t)=>e+t.score,0)/t.length).toFixed(1):"0.0"]})]}),c&&(0,o.jsxs)("div",{className:"jsx-8906bc3c0fc8bf3 glass-effect rounded-lg p-3",children:[(0,o.jsx)("div",{className:"jsx-8906bc3c0fc8bf3 text-sm text-blue-700 font-medium",children:"Modo Comparaci\xf3n Activo"}),(0,o.jsxs)("div",{className:"jsx-8906bc3c0fc8bf3 text-xs text-blue-600",children:[d.length,"/3 seleccionados"]})]})]}),n.layers.clusters&&(0,o.jsx)("div",{className:"jsx-8906bc3c0fc8bf3 absolute top-4 right-16 z-[1000]",children:(0,o.jsxs)("div",{className:"jsx-8906bc3c0fc8bf3 glass-effect rounded-lg p-3",children:[(0,o.jsx)("div",{className:"jsx-8906bc3c0fc8bf3 text-xs text-gray-700 font-medium mb-2",children:"Clusters por Score"}),(0,o.jsx)("div",{className:"jsx-8906bc3c0fc8bf3 space-y-1",children:[{range:"8.5+",color:"#22c55e",label:"Excelente"},{range:"7.5+",color:"#84cc16",label:"Muy Bueno"},{range:"6.5+",color:"#eab308",label:"Bueno"},{range:"5.5+",color:"#f97316",label:"Regular"},{range:"<5.5",color:"#ef4444",label:"Bajo"}].map(e=>{let{range:t,color:n,label:r}=e;return(0,o.jsxs)("div",{className:"jsx-8906bc3c0fc8bf3 flex items-center text-xs",children:[(0,o.jsx)("div",{style:{backgroundColor:n},className:"jsx-8906bc3c0fc8bf3 w-3 h-3 rounded-full mr-2 border border-white"}),(0,o.jsxs)("span",{className:"jsx-8906bc3c0fc8bf3 text-gray-600",children:[t," - ",r]})]},t)})})]})}),(0,o.jsx)("div",{className:"jsx-8906bc3c0fc8bf3 absolute bottom-2 right-2 z-[1000]",children:(0,o.jsx)("div",{className:"jsx-8906bc3c0fc8bf3 text-xs text-gray-500 bg-white bg-opacity-80 px-2 py-1 rounded",children:"\xa9 OpenStreetMap \xa9 CARTO \xa9 Esri"})}),(0,o.jsx)(a(),{id:"8906bc3c0fc8bf3",children:".custom-popup .leaflet-popup-content-wrapper{background:white;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;-webkit-box-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 10px 10px -5px rgba(0,0,0,.04);-moz-box-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 10px 10px -5px rgba(0,0,0,.04);box-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 10px 10px -5px rgba(0,0,0,.04);border:1px solid#e5e7eb}.custom-popup .leaflet-popup-tip{background:white;border:1px solid#e5e7eb}.municipality-tooltip{background:rgba(0,0,0,.8)!important;border:none!important;color:white!important;font-size:12px!important;padding:6px 10px!important;-webkit-border-radius:6px!important;-moz-border-radius:6px!important;border-radius:6px!important;font-weight:500!important}.marker-cluster-custom{background:transparent!important}.leaflet-control-zoom a{background:white!important;color:#374151!important;border:1px solid#d1d5db!important;font-size:16px!important;font-weight:bold!important}.leaflet-control-zoom a:hover{background:#f3f4f6!important;color:#111827!important}.leaflet-control-scale-line{background:rgba(255,255,255,.8)!important;border:2px solid#374151!important;color:#374151!important;font-weight:500!important}"})]})}}}]);