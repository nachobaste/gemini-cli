"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[465],{9465:function(e,r,t){t.d(r,{k:function(){return d}});var n=t(4513),a=t(90),c=t(5685),s=t(26),u=t(5977),o=t.n(u);function i(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function p(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?i(Object(t),!0).forEach(function(r){(0,n.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var f=(0,t(2276).eI)("https://iemhwwufuffbwgrzusjt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImllbWh3d3VmdWZmYndncnp1c2p0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTExMjYxMzEsImV4cCI6MjA2NjcwMjEzMX0.bhG23WjRqUE7AS18n-wYKJ1_Hx-_cuDJu8okON1e5cs"),l=function(e){if(e){if("string"==typeof e){var r=e.match(/\(([^,]+),([^)]+)\)/);if(r){var t=parseFloat(r[1]),n=parseFloat(r[2]);if(!isNaN(t)&&!isNaN(n))return{x:t,y:n}}}else if("object"==typeof e&&null!==e&&"number"==typeof e.x&&"number"==typeof e.y)return{x:e.x,y:e.y}}},d=function(){var e,r,t,n,u,i,d,v,m,h,w,b,x,y,k,_,j,g;function Z(){(0,c.Z)(this,Z)}return(0,s.Z)(Z,null,[{key:"getProjects",value:(e=(0,a.Z)(o().mark(function e(r,t){var n,c,s,u,i;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.from("projects").select("*, mcda_evaluations(*, mcda_parameters(*))").order("created_at",{ascending:!1}),r&&(n=n.eq("asset_class",r)),t&&(n=n.eq("development_category",t)),e.next=5,n;case 5:if(s=(c=e.sent).data,!(u=c.error)){e.next=10;break}throw u;case 10:return e.next=12,Promise.all(s.map(function(){var e=(0,a.Z)(o().mark(function e(r){var t;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.calculateMCDAScore(r.id);case 2:return t=e.sent,console.log("Project ".concat(r.id," MCDA Score:"),t),e.abrupt("return",p(p({},r),{},{coordinates:l(r.coordinates),mcda_score:t}));case 5:case"end":return e.stop()}},e)}));return function(r){return e.apply(this,arguments)}}()));case 12:return i=e.sent,e.abrupt("return",i);case 14:case"end":return e.stop()}},e)})),function(r,t){return e.apply(this,arguments)})},{key:"getProject",value:(r=(0,a.Z)(o().mark(function e(r){var t,n,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.from("projects").select("*, mcda_evaluations(*, mcda_parameters(*)), business_model_canvas(*)").eq("id",r).single();case 2:if(n=(t=e.sent).data,!(a=t.error)){e.next=7;break}throw a;case 7:return e.abrupt("return",p(p({},n),{},{coordinates:l(n.coordinates)}));case 8:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)})},{key:"createProject",value:(t=(0,a.Z)(o().mark(function e(r){var t,n,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.from("projects").insert(r).select().single();case 2:if(n=(t=e.sent).data,!(a=t.error)){e.next=7;break}throw a;case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})},{key:"updateProject",value:(n=(0,a.Z)(o().mark(function e(r,t){var n,a,c;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.from("projects").update(t).eq("id",r).select().single();case 2:if(a=(n=e.sent).data,!(c=n.error)){e.next=7;break}throw c;case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}},e)})),function(e,r){return n.apply(this,arguments)})},{key:"deleteProject",value:(u=(0,a.Z)(o().mark(function e(r){var t;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.from("projects").delete().eq("id",r);case 2:if(!(t=e.sent.error)){e.next=6;break}throw t;case 6:case"end":return e.stop()}},e)})),function(e){return u.apply(this,arguments)})},{key:"getMCDAParameters",value:(i=(0,a.Z)(o().mark(function e(){var r,t,n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.from("mcda_parameters").select("*").eq("is_active",!0).order("category",{ascending:!0}).order("name",{ascending:!0});case 2:if(t=(r=e.sent).data,!(n=r.error)){e.next=7;break}throw n;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}},e)})),function(){return i.apply(this,arguments)})},{key:"getMCDAParametersByCategory",value:(d=(0,a.Z)(o().mark(function e(){var r,t,n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.rpc("get_mcda_parameters_by_category");case 2:if(t=(r=e.sent).data,!(n=r.error)){e.next=7;break}throw n;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}},e)})),function(){return d.apply(this,arguments)})},{key:"updateMCDAParameters",value:(v=(0,a.Z)(o().mark(function e(r){var t,n,a,c;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.map(function(e){return{id:e.id,weight:e.weight}}),e.next=3,f.from("mcda_parameters").upsert(t,{onConflict:"id"}).select();case 3:if(a=(n=e.sent).data,!(c=n.error)){e.next=8;break}throw c;case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}},e)})),function(e){return v.apply(this,arguments)})},{key:"getProjectEvaluations",value:(m=(0,a.Z)(o().mark(function e(r){var t,n,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.rpc("get_project_evaluations",{project_uuid:r});case 2:if(n=(t=e.sent).data,!(a=t.error)){e.next=7;break}throw a;case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}},e)})),function(e){return m.apply(this,arguments)})},{key:"upsertMCDAEvaluation",value:(h=(0,a.Z)(o().mark(function e(r){var t,n,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.rpc("upsert_mcda_evaluation",{p_project_id:r.project_id,p_parameter_id:r.parameter_id,p_value:r.value,p_notes:r.notes});case 2:if(n=(t=e.sent).data,!(a=t.error)){e.next=7;break}throw a;case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}},e)})),function(e){return h.apply(this,arguments)})},{key:"calculateMCDAScore",value:(w=(0,a.Z)(o().mark(function e(r){var t,n,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.rpc("calculate_mcda_score",{project_uuid:r});case 2:if(n=(t=e.sent).data,!(a=t.error)){e.next=7;break}throw a;case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}},e)})),function(e){return w.apply(this,arguments)})},{key:"getBMC",value:(b=(0,a.Z)(o().mark(function e(r){var t,n,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.from("business_model_canvas").select("*").eq("project_id",r).single();case 2:if(n=(t=e.sent).data,!((a=t.error)&&"PGRST116"!==a.code)){e.next=7;break}throw a;case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}},e)})),function(e){return b.apply(this,arguments)})},{key:"upsertBMC",value:(x=(0,a.Z)(o().mark(function e(r){var t,n,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.from("business_model_canvas").upsert(r).select().single();case 2:if(n=(t=e.sent).data,!(a=t.error)){e.next=7;break}throw a;case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}},e)})),function(e){return x.apply(this,arguments)})},{key:"getBMCTemplates",value:(y=(0,a.Z)(o().mark(function e(){var r,t,n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.from("business_model_canvas").select("*").is("project_id",null);case 2:if(t=(r=e.sent).data,!(n=r.error)){e.next=7;break}throw n;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}},e)})),function(){return y.apply(this,arguments)})},{key:"getMunicipalities",value:(k=(0,a.Z)(o().mark(function e(){var r,t,n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.from("municipalities").select("*").order("name",{ascending:!0});case 2:if(t=(r=e.sent).data,!(n=r.error)){e.next=7;break}throw n;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}},e)})),function(){return k.apply(this,arguments)})},{key:"searchProjects",value:(_=(0,a.Z)(o().mark(function e(r,t,n){var a,c,s;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.rpc("search_projects",{search_term:r,status_filter:t,asset_class_filter:n});case 2:if(c=(a=e.sent).data,!(s=a.error)){e.next=7;break}throw s;case 7:return e.abrupt("return",c);case 8:case"end":return e.stop()}},e)})),function(e,r,t){return _.apply(this,arguments)})},{key:"getUserProfile",value:(j=(0,a.Z)(o().mark(function e(r){var t,n,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.from("user_profiles").select("*").eq("id",r).single();case 2:if(n=(t=e.sent).data,!((a=t.error)&&"PGRST116"!==a.code)){e.next=7;break}throw a;case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}},e)})),function(e){return j.apply(this,arguments)})},{key:"updateUserProfile",value:(g=(0,a.Z)(o().mark(function e(r,t){var n,a,c;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.from("user_profiles").upsert(p({id:r},t)).select().single();case 2:if(a=(n=e.sent).data,!(c=n.error)){e.next=7;break}throw c;case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}},e)})),function(e,r){return g.apply(this,arguments)})}]),Z}()}}]);